export const state = () => ({
  /**
   * All the retailer stores that a KeyMe kiosk can be found.
   * @type {Array}
   */
  locations: [
    {
      id: 'asdoiasdi2132193OIODioasd234',
      retailer: 'Rite Aid',
      address: '85-10 Northern Boulevard, Jackson Heights, NY, 11372',
      city: 'Jackson Heights',
      state: 'NY',
      coordinates: {
        lat: 40.7556469,
        lng: -73.88191789999996
      },
      phoneNumber: '718-213-2139',
      storeHours: {
        Sunday: '24h',
        Monday: '24h',
        Tuesday: '24h',
        Wednesday: '24h',
        Thursday: '24h',
        Friday: '24h',
        Saturday: '24h'
      },
      availableKeys: {
        'New York Yankees': {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Custom_Designs-772dcba451c6d7f30a0a74f399c76854.png'
        },
        'Hi-Performance': {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Hi-Performance_Keys-921c9673b3996cce53cd2aa5378fbb61.png'
        },
        Brass: {
          price: 7.49,
          src: 'https://cdn.key.me/assets/app/Brass_Keys-5f9622f8ced0b01f55277a118c90004d.png'
        },
        'NYU Subway': {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Custom_Designs-772dcba451c6d7f30a0a74f399c76854.png'
        },
        'Bottle Opener': {
          price: 9.49,
          src: 'https://cdn.key.me/assets/app/Accessories-6e1888005d079dedb190ab93f0cb5b20.png'
        },
        Dots: {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Custom_Designs-772dcba451c6d7f30a0a74f399c76854.png'
        }
      }
    },
    {
      id: 'zxpocxzopc2131242421',
      retailer: 'Kroger',
      address: '300 N Dean Rd, Auburn, AL',
      city: 'Auburn',
      state: 'AL',
      coordinates: {
        lat: 32.6107717,
        lng: -85.46340179999999
      },
      phoneNumber: '718-213-2139',
      storeHours: {
        Sunday: '24h',
        Monday: '24h',
        Tuesday: '24h',
        Wednesday: '24h',
        Thursday: '24h',
        Friday: '24h',
        Saturday: '24h'
      },
      availableKeys: {
        'New York Yankees': {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Custom_Designs-772dcba451c6d7f30a0a74f399c76854.png'
        },
        'Hi-Performance': {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Hi-Performance_Keys-921c9673b3996cce53cd2aa5378fbb61.png'
        },
        Brass: {
          price: 7.49,
          src: 'https://cdn.key.me/assets/app/Brass_Keys-5f9622f8ced0b01f55277a118c90004d.png'
        },
        'NYU Subway': {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Custom_Designs-772dcba451c6d7f30a0a74f399c76854.png'
        },
        'Bottle Opener': {
          price: 9.49,
          src: 'https://cdn.key.me/assets/app/Accessories-6e1888005d079dedb190ab93f0cb5b20.png'
        },
        Dots: {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Custom_Designs-772dcba451c6d7f30a0a74f399c76854.png'
        }
      }
    },
    {
      id: 'vcbcvbcv3444214214safdasf',
      retailer: 'Rite Aid',
      address: '337 Central Ave, Jersey City, NJ, 07307',
      city: 'Jersey City',
      state: 'NJ',
      coordinates: {
        lat: 40.7465856,
        lng: -74.04924389999996
      },
      phoneNumber: '718-213-2139',
      storeHours: {
        Sunday: '24h',
        Monday: '24h',
        Tuesday: '24h',
        Wednesday: '24h',
        Thursday: '24h',
        Friday: '24h',
        Saturday: '24h'
      },
      availableKeys: {
        'New York Yankees': {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Custom_Designs-772dcba451c6d7f30a0a74f399c76854.png'
        },
        'Hi-Performance': {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Hi-Performance_Keys-921c9673b3996cce53cd2aa5378fbb61.png'
        },
        Brass: {
          price: 7.49,
          src: 'https://cdn.key.me/assets/app/Brass_Keys-5f9622f8ced0b01f55277a118c90004d.png'
        },
        'NYU Subway': {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Custom_Designs-772dcba451c6d7f30a0a74f399c76854.png'
        },
        'Bottle Opener': {
          price: 9.49,
          src: 'https://cdn.key.me/assets/app/Accessories-6e1888005d079dedb190ab93f0cb5b20.png'
        },
        Dots: {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Custom_Designs-772dcba451c6d7f30a0a74f399c76854.png'
        }
      }
    },
    {
      id: 'hosadas2132412412',
      retailer: 'Bed Bath & Beyond',
      address: '850 3rd Avenue, Brooklyn, NY, 11232',
      city: 'Brooklyn',
      state: 'NY',
      coordinates: {
        lat: 40.6592281,
        lng: -74.0042818
      },
      phoneNumber: '718-213-2139',
      storeHours: {
        Sunday: '24h',
        Monday: '24h',
        Tuesday: '24h',
        Wednesday: '24h',
        Thursday: '24h',
        Friday: '24h',
        Saturday: '24h'
      },
      availableKeys: {
        'New York Yankees': {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Custom_Designs-772dcba451c6d7f30a0a74f399c76854.png'
        },
        'Hi-Performance': {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Hi-Performance_Keys-921c9673b3996cce53cd2aa5378fbb61.png'
        },
        Brass: {
          price: 7.49,
          src: 'https://cdn.key.me/assets/app/Brass_Keys-5f9622f8ced0b01f55277a118c90004d.png'
        },
        'NYU Subway': {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Custom_Designs-772dcba451c6d7f30a0a74f399c76854.png'
        },
        'Bottle Opener': {
          price: 9.49,
          src: 'https://cdn.key.me/assets/app/Accessories-6e1888005d079dedb190ab93f0cb5b20.png'
        },
        Dots: {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Custom_Designs-772dcba451c6d7f30a0a74f399c76854.png'
        }
      }
    },
    {
      id: 'zxpocxzopc2131242421',
      retailer: '7 Eleven',
      address: '1381 Atlantic Ave, Brooklyn, NY, 11216',
      city: 'Crown Heights',
      state: 'NY',
      coordinates: {
        lat: 40.6786822,
        lng: -73.94443160000003
      },
      phoneNumber: '718-213-2139',
      storeHours: {
        Sunday: '24h',
        Monday: '24h',
        Tuesday: '24h',
        Wednesday: '24h',
        Thursday: '24h',
        Friday: '24h',
        Saturday: '24h'
      },
      availableKeys: {
        'New York Yankees': {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Custom_Designs-772dcba451c6d7f30a0a74f399c76854.png'
        },
        'Hi-Performance': {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Hi-Performance_Keys-921c9673b3996cce53cd2aa5378fbb61.png'
        },
        Brass: {
          price: 7.49,
          src: 'https://cdn.key.me/assets/app/Brass_Keys-5f9622f8ced0b01f55277a118c90004d.png'
        },
        'NYU Subway': {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Custom_Designs-772dcba451c6d7f30a0a74f399c76854.png'
        },
        'Bottle Opener': {
          price: 9.49,
          src: 'https://cdn.key.me/assets/app/Accessories-6e1888005d079dedb190ab93f0cb5b20.png'
        },
        Dots: {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Custom_Designs-772dcba451c6d7f30a0a74f399c76854.png'
        }
      }
    },
    {
      id: 'assd45522132132',
      retailer: 'Rite Aid',
      address: 'W 24th Street, NY 282 8th Avenue, New York, NY, 10001',
      city: 'New York',
      state: 'NY',
      coordinates: {
        lat: 40.7459871,
        lng: -73.9975427
      },
      phoneNumber: '718-213-2139',
      storeHours: {
        Sunday: '24h',
        Monday: '24h',
        Tuesday: '24h',
        Wednesday: '24h',
        Thursday: '24h',
        Friday: '24h',
        Saturday: '24h'
      },
      availableKeys: {
        'New York Yankees': {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Custom_Designs-772dcba451c6d7f30a0a74f399c76854.png'
        },
        'Hi-Performance': {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Hi-Performance_Keys-921c9673b3996cce53cd2aa5378fbb61.png'
        },
        Brass: {
          price: 7.49,
          src: 'https://cdn.key.me/assets/app/Brass_Keys-5f9622f8ced0b01f55277a118c90004d.png'
        },
        'NYU Subway': {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Custom_Designs-772dcba451c6d7f30a0a74f399c76854.png'
        },
        'Bottle Opener': {
          price: 9.49,
          src: 'https://cdn.key.me/assets/app/Accessories-6e1888005d079dedb190ab93f0cb5b20.png'
        },
        Dots: {
          price: 8.49,
          src: 'https://cdn.key.me/assets/app/Custom_Designs-772dcba451c6d7f30a0a74f399c76854.png'
        }
      }
    }
  ],
  /**
   * Whether the "request local kiosk" dialog is open or not.
   * @type {Boolean}
   */
  isRequestKioskDialogOpen: false,
  /**
   * All the requests of users for kiosks in their location.
   * @type {Array}
   */
  localKioskRequests: [],
  /**
   * The user's geolocation via HTML5's geolocation GPS API.
   * @type {Object}
   */
  geolocation: {
    /**
     * The latitudinal location of the user fetched by HTML5 gps api.
     * @type {Number}
     */
    lat: null,
    /**
     * The longitudinal locatio nof the user fetched by HTML5 gps api.
     * @type {Number}
     */
    lng: null
  },
  /**
   * Whether the app snackbar is open.
   * @type {Boolean}
   */
  isSnackbarOpen: false,
  snackbarMessage: '',
  locationDetails: {
    visible: false,
    location: null
  },
  search: ''
})

export const getters = {
  /**
   * Tries to get the kiosk location that the user is trying to search for.
   * @method filteredLocations
   * @return {Array} - An array of kiosk locations.
   */
  filteredLocations (state) {
    // allows user to search with tags or individual words
    const filterTags = state.search.toLowerCase().split(' ')

    return state.locations.filter(location => {
      // combine all the searchable criteria and lowercase it
      let locationBlob = location.address + location.retailer + location.state + location.city

      locationBlob = locationBlob.toLowerCase()

      // see if the location matches all provided filter tags
      let matches = true
      filterTags.forEach((filterTag) => {
        if (!locationBlob.includes(filterTag)) {
          matches = false
        }
      })

      // add location to array if tag words match meta
      return matches
    })
  }
}

export const mutations = {
  /**
   * Updates the search bar input with user input.
   * @method updateSearch
   * @param  {Object} state - The application level state.
   * @param  {String} payload - The input text in the kiosk finder search bar.
   * @return {Void}
   */
  updateSearch (state, payload) {
    state.search = payload
  },
  /**
   * Open or close the "request local kiosk" dialog.
   * @method toggleRequestKioskDialog
   * @param  {Object} state - The application level state.
   * @param  {Boolean} payload - Optional parameter whether the dialog is open.
   * @return {Void}
   */
  toggleRequestKioskDialog (state, payload) {
    if (payload) {
      state.isRequestKioskDialogOpen = payload
    } else {
      state.isRequestKioskDialogOpen = !state.isRequestKioskDialogOpen
    }
  },
  /**
   * Add a user request for a kiosk in a location.
   * @method submitLocalKioskRequest
   * @param  {Object} state   - The application level state.
   * @param  {Object} payload - The content of the request the user made.
   * @return {Void}
   */
  submitLocalKioskRequest (state, payload) {
    state.localKioskRequests.push(payload)
  },
  /**
   * Updates the geolocation of the user.
   * @method updateGeolocation
   * @param  {Object} state - The application level state.
   * @param  {Object} payload - The coordinates of the user.
   * @return {Void}
   */
  updateGeolocation (state, payload) {
    state.geolocation = {
      lat: payload.lat,
      lng: payload.lng
    }
  },
  /**
   * Opens or closes the app snackbar.
   * @method toggleSnackbar
   * @param  {Object} state - The application state.
   * @param  {Boolean} payload - Optionally holds whether to open or close the
   * snackbar as well as the message for the snackbar.
   * @return {Void}
   */
  toggleSnackbar (state, payload) {
    state.isSnackbarOpen = payload.display

    // optional paylaod
    if (payload.message) state.snackbarMessage = payload.message
  },
  toggleLocationDetails (state, payload) {
    state.locationDetails.visible = payload.visible
    state.locationDetails.location = payload.location
  }
}
